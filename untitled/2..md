# 3.관계 데이터베이스 모델과 언어

## &lt;관계형 데이터베이스의 구조&gt;

#### 1\)관계형 데터베이스의 구조

* 1970 IBM에 근무하던 코드 \(E. F. Codd\)에 의해 처음 제안
* 관계형 테이터베이스를 구성하는 개체\(Entity\)나 관계\(Relationship\)를 모두 릴레이션\(Relation\)이라는 표\(table\)로 표현
* 릴레이션은 개체를 표현하는 개체 릴레이션, 관계를 나타내는 관계 릴레이션으로 구분
* 장점: 간결하고 보기 편리, 다르 데이터 베이스로의 벼노한이 용이
* 단점: 성능이 다소 떨어진다.

#### 2\) 관계형 데이터베이스의 Relation 구조

릴레이션은 데이터들을 표\(Table\)의 형태로 표현한 것으로 구조를 나타내는 릴레이션 스키마와 실제 값들인 릴레이션 인스턴스로 구성된다.

#### 릴레이션 구성요소

* 튜플\(Tuple\)
  * 릴레이션을 구성하는 각각의 행을 말함 \(가로, Structure\)
  * 튜플은 속성의 모임으로 구성
  * 파일 구조에서 레코드와 같은 의미
  * 튜플의 수를 카디널리티\(Cardinality\) 또는 기수, 대응수라고 한다.
  * 튜플의 집합 릴레이션 인스턴
* 속성\(Attribute\)
  * 속성은 데이터베이스를 구성하는 가장 작은 논리적 단위
  * 파일 구조사으이 데이터 항목\(item\) 또는 데이터 필드\(field\)에 해당
  * 속성은 개체의 특성 기술
  * 속성의 수를 디그리\(Degree\) 또는 차수라고 한다.
  * 속성의 집합 = 릴레이션 스키
* 도메인\(Domain\)
  * 도메인은 하나의 애트리뷰트가 취할 수 잇는 같은 타입의 원자\(Atomic\)값들의 집합이다.
  * 도메인은 실제 애트리뷰트 값이 나타날 때 그 값의 하법 여부를 시스템이 검사하는 데에도 이용
  * 속성의 범위 ex\) 학년이라는 속성의 범위 1학년 ~ 4학년
* 릴레이션의 특징
  * 릴레이션 스키마\(속성 \)+ 릴레이션 인스턴스\(튜플\)  = 릴레이션\(테이블\)
  * 한 릴레이션에는 똑같은 튜플 없음 다 다름
  * 튜플들의 삽입, 삭제로 인해 릴레이션은 시간에 따라 변함
  * 릴레이션 스키마를 구성하는 속성들 간의 순서는 중요하지 X
  * 속성의 유일한 식별을 위해 속성의 명칭은 유일해야 하지만 속성을 구성하는 값은 중복 가능
  * 릴레이션을 구성하는 튜플을 유일하게 식별하기 위해 부분집합을 키로 설정

## &lt;관계형 데이터베이스의 제약 조건&gt;

\*제약조건이란 DB에 저장되느 데이터의 정확성을 보장하기 위해 키를 이용해 입려고디는 데이터에 제한을 주는 것으로 개체 무결성 제약, 참조 무결성 제약 등이 해당된다.

#### 1\) 키의 개념 및 종류

Key: DB에서 조건에 만족하느 튜플을 찾거나 순서대로 정렬할 때 튜플들을 서로 구분할 수 있는 기준이 되는 애트리뷰트를 말한다.

#### 후보키\(Candidate Key\)

* 튜플을 유일하게 식별하기 위해 사용하는 속성들의 부분집합, 즉 기본키로 사용할 수 있는 모든 속성들 = 중복 없는 유일한 
* 릴레이션에는 하나 이상의 후보키가 존재
* 유일성과 최소성을 만족해야함 
  * 유일성\(Unique\): 하나의 키 값으로 하나의 튜플만을 유일하게 식별할 수 있어야 한다.
  * 최소성\(Minimality\): 모든 레코드들으 유일하게 식별하는 데 꼭 필요한 속성으로만 구성

#### 기본키\(Primary Key\)

* 기본키는 후보키 중에서 선택한 주키\(Main key\)이다.
* 한 릴레이션에서 특정 튜플을 유일하게 구별할 수 있는 속성이다.
* Null 값을 가질 수 없다.
* 기본키로 정의된 속성에는 동일한 값이 중복 저장될 수 없다.

#### 대체키\(Alternate Key\)

* 후보키가 둘 이상일 때 기본키를 제외한 나머지 후보키들을 말함
* 보조키라고도 함

#### 슈퍼키\(Super Key\)

* 슈퍼키는 한 릴레이션 내에 있는 속성들의 집합으로 구성된 키로 릴레이션을 구성하는 모든 튜플들 중 슈퍼키로 구성된 속성의 집합과 동한 값은 나타나지 않는다.
* 슈퍼키는 릴레이션을 구성하는 모든 튜플에 대해 유일성은 만족시키지만 최소성은 만족시키지 못한다.

#### 외래키\(Foreign Key\)

* 관계를 맺고 있는 릴레이션 R1, R2에서 릴레이션 R1이 참조하고 있는 릴레이션 R2의 기본키와 같은 R1릴레이션의 속성을 외래키라고 한다.
* 외래키는 참조되는 릴레이션의 기본키와 대응돼 릴레이션 간의 참조 관계를 표현하는 데 중요한 도구이다.
* 외래키로 지정되면 참조 릴레이션의 기본키에 없 값은 입력할 수 없다.

#### 2\) 무결성

#### **개체 무결성 \(기본키와 관련\)**

릴레이션에서 기본키를 구성하는 속성은 널\(null\)값이나 중복값을 가질 수 없다. \*기본키는 최소성, 유일성, not null값을 유지해야함\*

#### 참조 무결성 \(외래키와 관\)

* 외래키 값은 null이거나 참조릴레이션의 기본키 값과 동일해야한다. \(빈칸 가능 But, 원래 기본키중 없는 값은 불가능\)
* 외래키와 참조하려는 테이블의 기본키는 도메인과 속성 개수가 같아야한다.

## &lt;관계대수 및 관계해석&gt;

#### 1\) 관계대수의 개요

* 관계대수는 관계형 데이터베이스에서 원하는 정보와 그 정보를 검색하기 위해 어떻게 유도하는가를 기술하는 절차적 언어
* 릴레이션을 처리하기 위해 연산자와 연산규칙을 제공하는 언어로 피연산자가 릴레이션이고 결과도 릴레이션
* 질의에 대한 해를 구하기 위해 수행해야 할 연산의 순서를 명시
* **순수 관계 연산자: Selete, Project, Join, Division**
* **일반집합연산자**

**2\) 순수 관계 연산자**

**Select \(튜플 검색\)**

* Select는 릴레이션에 존재하는 튜플 중에서 선택 조건을 만족하는 튜플의 부분집합을 구해 새로운 릴레링션을 만든다.
* 릴레이션의 행\(가로\)에 해당하는 튜플을 구하는 것이므로 수평 연산이라고도 한다.
* 연산자의 기호는 그리스 문자 시그마를 사용

#### Project\(속성 검색\)

* Project는 주어진 릴레이션에서 속성 List에 제시된 Attribute만을 추출하는 연산
* 릴레이션의 열\(세로\)에 해당하는 속성을 추출하는 것 수직 연산자라고도 한다.
* 연사자의 기호는 그리스 문자 파이를 사

**Join \(릴레이션 두개 합치기\)**

* Join은 공통속성을 중심으로 두개의 릴레이션을 하나로 합쳐서 새로운 릴레이션을 만드는 연산이다.
* 연산자 기호는 나비 넥타이

**Division \(릴레이션 두개 나누기\)**

* Division은 Y가 X의 부분집합일때 두개의 릴레이션 R\(x\)와 S\(y\)ㅏ 있으 ㄹ때 R의 속서잉 S의 속성값을 모두 가진 튜플에서 S가 가진 속성을 제외한 속성만을 구하는 연산이다.
* 연사자 기호는 나누셈 기호



## &lt;정규화 \(Normalization\)&gt;

#### 1\)정규화의 개요

* 정규화란 함수적 종속성등의 종속성 이론을 이용해 잘못 설계된 관계형 스키마를 더 작은 속성의 세트로 쪼개 바람직한 스키마로 만들어 가는 과정
* 하나의 종속성이 하나의 릴레이션에 표현되도록 분해
* 차수가 높아질수록 만족시켜야 할 제약조건이 늘어난다
* 데이터베이스의 논리적 설계 단계에서 수행
* 논리적 처리 및 품질에 큰 영향을 미친다.

#### 2\) 정규화의 목적

* 데이터 구조의 안정성을 최대화
* 어떤 릴레이션이라도 데이터베이스 내에서 표현 가능하게 만든다
* 효과적인 검색 알고리즘을 생성
* 중복을 배제해 사빕, 삭제, 갱신 이상의 발생을 방지
* 데이터 삽입 시 릴레이션을 재구성할 필요성을 줄인다

#### 3\) Anomaly\(이상\)의 개념 및 종류

정규화를 거치지 않으면 데이터베이스 내에 데이터들이 불필요하게 중복돼 릴레이션 조작 시 예기치 못한 곤란한 현상이 발생하는데 이를 이상\(Anomaly\)라 하며 다음과 같은 이상이 있다.

* 삽입 이상\(Insertion Anomaly\): 릴레이션에 데이터를 삽입할 때 의도와 상관없이 원하지 않는 값이 함께 삽입 되는 것
* 삭제 이상\(Deletion Anomaly\): 릴레이션에서 한 튜플을 삭제할 때 의도와 상관없는 값들도 함께 연쇄 삭제되는 것
* 갱신 이상\(Update Anomaly\): 릴레이션에서 튜를에 있는 속성값을 갱신할때 일부 튜플의 정보만 갱신돼 정보에 모수닝 생기는 현상

#### 4\) 정규화의 원칙

* **정보의 무손실 표현**, 하나의 스키마를 다른 스키마로 변환할 때 정보의 손시링 있어서는 안됨
* **분리의 원칙**, 하나의 독립된 관계성으 하나의 독립된 릴레이션으로 분리시켜 표현해야 한다.
* **데이터의 중복성 감소**

#### 5\) 정규화 과정

#### 1NF\(제1정규형\)

* 1NF는 릴레이션에 속한 모든 도메인이 원자값\(Atomic Value\)만으로 돼 있는 릴레이션
* 릴레이션의 모든 속성이 단순 영역에서 정의

#### 2NF\(제2정규형\)

* 2NF는 릴렐이션 R이 1NF이고 키가 아닌 모든 속성이 기본키에 대해 완전 함수적 종속관계를 만족

{% hint style="info" %}
함수적 종속 관계: &lt;수강&gt;릴레이이\(학번, 이름, 과목명\)으로 돼 있을 때, '학번'이 결정되면 '과목명'에 상관없이 '학'에는 항상 같은 이름이 대응, '학번'에 따라 '이름'이 결정될 때 '이름'을 '학번'에 함수 종속적이라고 하며 '학번 -&gt; 이름'과 같이 씀

완전 함수적 종속 관계: 속성 A가 다른 속성들의 집합 B 전체에 대해 함수적 종속 관계를 갖지만 집합 B의 진부분집합에 대해는 종속 관계를 갖지 않으면, 속성 A는 집합 B의 속성들에 대해 완전 함수적 종속 관계에 있다고 합니다.  예\) &lt;수강&gt;릴레이션이  \(학번, 과목명, 성적\)으로 돼 있을 때 '성적'은  \(학번, 과목명\)에는 함수 종속이지만, \(학번\)이나 \(과목명\)에는 함수 종속이 아닙니다.
{% endhint %}

**3NF\(제3정규형\)**

릴레이션 R이 2NF이고  키가 아닌 모든 애트리뷰트가 기본키에 대해 이행적 종속 관계를 이루지 않도록 제한한 관계형이다.

* 무손실 조인 또는 종속성 보존을 저해하지 않고도 항상 3NF 설계를 얻을 수 있다.

{% hint style="info" %}
정규화 과정 정리 =&gt; 도부이결다조
{% endhint %}



## &lt;SQL의 개념&gt;

**1\)SQL\(Structured Query Language\)의 개요**

* 국제표준 데이터베이스 언어이며 많은 회사에서 관꼐형 데이터베이스\(RDB\)를 지원하는 언어로 채택하고 있다.
* 관계대수와 관계해석을 기초로 한 혼합데이터 언어
* 질의어지만 징의 기능만 있는 것이 아니라 데이터 구조의 정의, 데이터 조작, 데이터 제어 기능을 모두 갖추고 있다.

**2\) SQL의 분류**

**DDL\(Data Define Language\)데이터 정의어**

* DDL은 SCHEMA, DOMAIN, TABLE, VIEW, INDEX를 정의하거나 변경 또는 삭제할때 사용하는 언어
* 논리적 데이터 구조와 물리적 데이터 구조의 사사응 정의
* 데이터베이스 관리자나 데이터베이스 설계자가 사용
* DDL =&gt; CREATE\(정의\), ALTER\(변경\), DROP\(삭제\)

**DML\(Data Manipulation Language\)데이터 조작어**

* DML은 데이터베이스 사용자가 응용프로그램이나 질의어를 통해 저장된 데이터를 실질적으로 처리하는 데 사용되는 언어
* 데이터베이스 사용자와 데이터베이스 관리 시스템 간의 인터페이스를 제공
* DML =&gt; SELECT\(검색\), INSERT\(삽입\), DELETE\(삭제\), UPDATE\(내용변경\)

**DCL\(Data Control Language\) 데이터 제어어**

* DCL은 데이터의 보안, 무결성, 회복, 병행 수행 제어 등을 정의 하는 데 사용되는 언어
* 데이터베이스 관리자가 데이터 관리를 목적으로 사용
* DCL =&gt; COMMIT\(결과 저장, 완료됐을을 관리자에게 알림\), ROLLBACK\(원래의 상태로 복구\), GRANT\(권한 부여\), REVOKE\(권한 취소\)

## DDL

* 데이터정의어는 SCHEMA, DOMAIN, TABLE, VIEW, INDEX 정의, 변경, 삭제할 때 사용하는 명령문.
* DDL로 정의된 내용은 Meta-data가 됨, 시스템 카탈로그에 저장됨

\*데이터 정의문에서 사용하는 테이블 종류 = &gt; 기본테이블, 뷰테이블, 임시테이블\*

#### 1\) CREATE SCHEMA 

* 스키마를 정의하는 명령문이다
* 스키마의 식별을 위해 스키마 이름과 소유권자나 허가권자를 정의
* 표기 형식 

```text
CREATE SCHEMA 스키마_이름 AUTHORIZATION 사용자_id;

예시) CREATE SCHEMA 대학교 AUTHORIZATION 홍길동;
```

#### 2\) CREATE DOMAIN 

* 도메인을 정의하는 명령문
* 임의의 애트리뷰트\(속성\)에서 취할 수 있는 원자값의 버위가 SQL에서 지원하는 data\_type에 포함되는 전체 값이 아니고 일부분일 때 사용자가 그 값의 범위를 사용자정의 data\_type 으로 정의한다
* 표기 형식
  * data\_type: SQL에서  지원하는 data\_type 
  * 묵시값: 데이터를 입력하지 않았을 때 자동으로 입력되는 기본 값\(디볼트값\)
  * 정의된 도메인\_이름은 일반적인 data\_type처럼 사용한다.

```text
CREATE DOMAIN 도메인_이름 data_tpye
    [DEFAULT 묵사값_정의]
    [CONSTRAINT VALID 도메인_이름 CHECK(범위값)];
    
예시) 
CREATE DOMAIN SEX CHAR(1) 
    DEFAULT '여'
    CONSTRAINT VALID-SEX CHECK(VALUE IN ('남', '여','?'));
```

#### 3\)  CREATE TABLE

* 기본테이블을 정의하는 명령문이다.
* 표기 형식
  * 속성명: 기본 테이블에 포함될 모든 속성에 대해 속성명과 그 속성의 data\_type,  NOT NULL여부를 지정
  * PRIMARY KEY: 기본키 속성 지정
  * UNIQUE: 대체키로 사용할 속성명들을 지정한다.
  * FOREIGN KEY~ REFERENCES  
    * 참조할 다른 테이블과 그 테이블을 참조할 때 사용할 외래키 속성을 지정한다.
    * 외래키가 지정되면 참조 무결성의 CASCADE 법칙이 적용
* CHECK: 제약조건을 정의

```text
CREATE TABLE 기본테이블_이름
    (속성명 data_type[NOT NULL],...,
    PRIMARY KEY(기본키_속성명),
    UNIQUE(대체키_속성명,..),
    FOREIGN KEY(외래키_속섬명,...),
        REFERENCES 참조테이블(기본키_속성명),
    CONSTRAINT 제약조건명 CHECK(조건식) );
    
예시)

CREATE TABLE 학
    (이름 VARCHAR(15) NOT NULL,
    학번 VARCHAR(15) NOT NULL,
    전공 VARCHAR(15) NOT NULL,
    성별 SEX,
    생년월일 DATE,
    PRIMARY KEY(학번),
    FOREIGN KEY(전공),
        REFERENCES 학과(학과코드),
    CONSTRAINT 성별제약 CHECK(성별='남') );
```



